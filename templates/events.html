{% extends 'base.html' %}

{% block content %}

<h2>Upcoming Events</h2>

{% for event in events_list %}
<div class="card mb-3 w-75">
    {% if 'proxy_image' in event.featured_image.url  %}
    <img src="https://cdn.seeklearning.com.au/media/images/career-guide/article/career-advice/web_images/blogs/214/6084/How-music-and-sound-can-help-alleviate-career-anxiety_940x485.jpg"
        class="card-img-top" alt="featured_image">
    {% else %}
    <img src="{{ event.featured_image }}" class="card-img-top" alt="featured_image">
    {% endif %}

    <div class="card-body">
        <h5 class="card-title"><a href="{% url 'event_details' event.slug %}">{{ event.title }}</a></h5>
        <p class="card-text">{{ event.blurb }}</p>
        <p class="card-text"><small class="text-muted">{{ event.event_date}} | {{ event.event_time }}</small></p>
    </div>
</div>
{% endfor %}

{% if is_paginated %}
<nav aria-label="list of events">
    <ul class="pagination">
        {% if page_obj.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link">Previous</a>
        </li>
        {% endif %}

        {% if page_obj.number > 2 %}

        {% if page_obj.has_next %}
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.number|add:'-1'}}">
                {{ page_obj.number|add:"-1" }}</a></li>
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.number }}">{{ page_obj.number }}</a>
        </li>
        {% else %}
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.number|add:'-2'}}">
                {{ page_obj.number|add:"-2" }}</a></li>
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.number|add:'-1' }}">
                {{ page_obj.number|add:"-1" }}</a>
        </li>
        {% endif %}

        {% else %}
        <li class="page-item"><a class="page-link" href="?page=1">1</a></li>
        <li class="page-item"><a class="page-link" href="?page=2">2</a></li>
        {% endif %}

        {% if page_obj.paginator.num_pages >= 3%}
        {% if page_obj.number >= 3 and page_obj.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.number|add:'1' }}">
                {{ page_obj.number|add:"1" }}
            </a>
        </li>
        {% elif not page_obj.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.number }}">
                {{ page_obj.number }}
            </a>
        </li>
        {% else %}
        <li class="page-item"><a class="page-link" href="?page=3">3</a></li>
        {% endif %}
        {% endif %}

        {% if page_obj.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link">Next</a>
        </li>
        {% endif %}
    </ul>
</nav>
{% endif %}

{% endblock content %}